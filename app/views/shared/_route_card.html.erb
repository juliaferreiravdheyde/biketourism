<%= link_to route_path(route) do %>
  <div class="card-product">
    <% if route.photos.attached? %>
      <%= cl_image_tag route.photos[0].key, class: "product-image primary-image", data: { 'picker-target': "pimage" } %>
    <% else %>
      <% default_image_url = case route.type_of_route
                             when "Urban"
                               then "urban.webp"
                             when "Suburban"
                               then "suburban.webp"
                             when "CountrySide"
                               then "countryside.webp"
                             when "Mountain"
                               then "mountain.webp"
                             end
      %>
      <%= image_tag default_image_url, class: "product-image primary-image" %>
    <% end %>
    <div class="card-route-details">
      <ul>
        <li><span class="type"><%= route.type_of_route %></span></li>
        <li><h3><%= route.name %></h3></li>
        <li><p><%= route.description %></p></li>
        <li><span class="distance">Distance: <%= route.distance < 1000 ? "#{route.distance}m" : "#{(route.distance / 1000.0).round(2)}km" %></span></li>
      </ul>
      <% pinned_route = current_user.pinned_route %>
      <% if pinned_route == route %>
        <%= link_to pinned_route_path, method: :delete, remote: true, data: { turbo_frame: "route-cards" }, class: "btn-pin" do %>
        <%#= link_to pinned_route_path(pinned_route), data: { turbo_method: :delete}, class: "btn-pin" do %>

        <% end %>
      <% else %>
        <%= link_to pinned_routes_path(route_id: route.id), method: :post, remote: true, data: { turbo_frame: "route-cards" }, class: "btn-pin" do %>
        <%#= link_to pinned_routes_path(route_id: route.id), data: { turbo_method: :post}, method: :post, class: "btn-pin" do %>
         <i class="fa-regular fa-thumbtack"></i>
        <% end %>
      <% end %>


      <% favorite = Favorite.where(route: route, user: current_user) %>
      <% if favorite.present? %>
        <%= link_to favorite_path(favorite.first), data: { turbo_method: :delete }, class: "bookmark" do %>
          <i class="fa-brands fa-gratipay"></i>
        <% end %>
      <% else %>
        <%= link_to route_favorites_path(route), data: { turbo_method: :post }, class: "bookmark" do %>
          <i class="fa-sharp fa-regular fa-heart"></i>
        <% end %>
      <% end %>
    </div>
  </div>
<% end %>
