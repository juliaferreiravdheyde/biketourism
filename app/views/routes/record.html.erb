<div class="container mt-3">
  <div data-controller = 'route-tracking' data-route-tracking-id-value='<%= @route.id %>'>
    <div  data-route-tracking-target='tracker' class=<%= 'd-none' if @route.errors.any? %>>
      <div class='record-top-half-display'>
        <div class='recording-gif'>
          <%= image_tag('recording.gif', class: 'd-none', data: { route_tracking_target: 'recordgif'} )%>
        </div>
        <%# INCLUDE MAP HERE BEFORE SAVE %>
      </div>
      <button class='btn btn-primary w-100 mb-3' data-route-tracking-target='startstop' data-action='click->route-tracking#trackRoute'>Track Route</button>
      <div class="recording mt-5 mb-5">
        <p data-route-tracking-target = 'status', class='font-2-s cor-8 text-center' ></p>
        <p data-route-tracking-target = 'position', class='font-2-s cor-8 text-center'></p>
      </div>
      <div class="d-flex gap-3">
        <button class='btn btn-success d-none w-100' data-route-tracking-target='save' data-action='click->route-tracking#showForm'>Save</button>
        <%= link_to 'Discard', route_path(@route), onclick: flash[:notice] = 'Route discarded', data: { route_tracking_target: 'discard', turbo_method: :delete, turbo_confirm: "Are you sure?" }, class: 'btn btn-danger d-none w-100' %>
      </diV>
    </div>
    <%#
      <div style="width: 100%; height: 300px;"
      data-controller="map"
      data-map-markers-value="<%= @route.points.map { |point| { lat: point.latitude, lng: point.longitude } }.to_json "
      data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] ">
      </div> %>
    <%= simple_form_for @route, url: register_path(@route), method: 'PATCH', html: { class: @route.errors.any? ? "" : "d-none", data: { route_tracking_target: 'registerform'} } do |f| %>
    <h2 class="mb-3 cor-12 font-1-m-b">Post your route</h2>
      <div class="form-inputs cor-9 font-2-xs">
        <%= f.input :name %>
        <%= f.input :description %>
        <%= f.input :type_of_route, collection: Route::TYPE_OF_ROUTE %>
        <%= f.input :photos, as: :file, input_html: {multiple: true, class: "cor-9 font-2-xs"}  %>
        <div class="form-actions">
          <%= f.button :submit, "Post Route", class:"btn-primary btn-block mb-3 w-100" %>
        </div>
      <% end %>
    </div>
  </div>
</div>
